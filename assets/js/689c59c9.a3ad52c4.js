"use strict";(self.webpackChunkblogs=self.webpackChunkblogs||[]).push([[9275],{28453:(e,t,r)=>{r.d(t,{R:()=>d,x:()=>o});var n=r(96540);const s={},i=n.createContext(s);function d(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),n.createElement(i.Provider,{value:t},e.children)}},83777:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>a,frontMatter:()=>d,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"http/route","title":"route","description":"When you define a route, you expose a resource through a specific path that clients can request. you then add an Endpoint on the route to determin what clients can do with the resource.","source":"@site/docs/http/route.md","sourceDirName":"http","slug":"/http/route","permalink":"/docs/http/route","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"route"},"sidebar":"tutorialSidebar","previous":{"title":"endpoint","permalink":"/docs/http/endpoint"},"next":{"title":"application","permalink":"/docs/http/app"}}');var s=r(74848),i=r(28453);const d={sidebar_position:2,title:"route"},o=void 0,c={},l=[{value:"Defining an route",id:"defining-an-route",level:2},{value:"Register endpoint to an route.",id:"register-endpoint-to-an-route",level:3},{value:"Defining an sub-route",id:"defining-an-sub-route",level:2},{value:"The root route",id:"the-root-route",level:2}];function h(e){const t={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.p,{children:["When you define a route, you expose a resource through a specific ",(0,s.jsx)(t.strong,{children:"path"})," that clients can request. you then add an ",(0,s.jsx)(t.code,{children:"Endpoint"})," on the route to determin what clients can do with the resource."]}),"\n",(0,s.jsxs)(t.p,{children:["Take url ",(0,s.jsx)(t.code,{children:"https://dontclickme.com/users"})," as an example, path ",(0,s.jsx)(t.code,{children:"/users"})," would locate resource ",(0,s.jsx)(t.code,{children:"users"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"defining-an-route",children:"Defining an route"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'from lihil import Route\n\nusers_route = Route("/users")\n'})}),"\n",(0,s.jsxs)(t.p,{children:["If you have existing ",(0,s.jsx)(t.code,{children:"lihil.Graph"})," and ",(0,s.jsx)(t.code,{children:"lihil.MessageRegistry"})," that you would like to use, put then in the route constructor."]}),"\n",(0,s.jsx)(t.p,{children:"This is useful if you keep dependencies and event listeners in separate files, example:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"from project.users.deps import user_graph\nfrom project.users.listeners import user_eventregistry\n\nuser_route = Route(graph=uesr_graph, registry=user_eventregistry)\n"})}),"\n",(0,s.jsx)(t.p,{children:"You can also add middlewares to a route if you want them to apply only to that specific route."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"from starlette.middleware.cors import CORSMiddleware\nfrom starlette.middleware.httpsredirect import HTTPSRedirectMiddleware\n\nRoute(middlewares=[CORSMiddleware])\nroute.add_middleware(HTTPSRedirectMiddleware)\n"})}),"\n",(0,s.jsx)(t.h3,{id:"register-endpoint-to-an-route",children:"Register endpoint to an route."}),"\n",(0,s.jsxs)(t.p,{children:["In previous dicussion, we expose ",(0,s.jsx)(t.code,{children:"create_user"})," as an endpoint for ",(0,s.jsx)(t.code,{children:"POST"})," request of ",(0,s.jsx)(t.code,{children:"users_route"}),".\nwe can also declare other http methods with similar syntax, this includes:"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Method"}),(0,s.jsx)(t.th,{children:"Idempotent"}),(0,s.jsx)(t.th,{children:"Purpose"}),(0,s.jsx)(t.th,{children:"Example"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"GET"})}),(0,s.jsx)(t.td,{children:"Yes"}),(0,s.jsx)(t.td,{children:"Retrieve data without modifying the server state"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"@route.get"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"POST"})}),(0,s.jsx)(t.td,{children:"No"}),(0,s.jsx)(t.td,{children:"Submit data to create a resource or trigger action"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"@route.post"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"HEAD"})}),(0,s.jsx)(t.td,{children:"Yes"}),(0,s.jsx)(t.td,{children:"Same as GET but returns only headers"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"@route.head"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"OPTIONS"})}),(0,s.jsx)(t.td,{children:"Yes"}),(0,s.jsx)(t.td,{children:"Discover allowed methods and CORS info"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"@route.options"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"TRACE"})}),(0,s.jsx)(t.td,{children:"Yes"}),(0,s.jsx)(t.td,{children:"Echo the received request (for debugging)"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"@route.trace"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"PUT"})}),(0,s.jsx)(t.td,{children:"Yes"}),(0,s.jsx)(t.td,{children:"Replace a resource with the provided data"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"@route.put"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"DELETE"})}),(0,s.jsx)(t.td,{children:"Yes"}),(0,s.jsx)(t.td,{children:"Remove a resource"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"@route.delete"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"PATCH"})}),(0,s.jsx)(t.td,{children:"No"}),(0,s.jsx)(t.td,{children:"Apply partial modifications to a resource"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"@route.patch"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"CONNECT"})}),(0,s.jsx)(t.td,{children:"No"}),(0,s.jsx)(t.td,{children:"Establish a tunnel to the server (e.g., HTTPS)"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"@route.connect"})})]})]})]}),"\n",(0,s.jsx)(t.p,{children:"This means that an route can have 0-9 endpoints."}),"\n",(0,s.jsx)(t.p,{children:"to expose a function for multiple http methods"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"apply multiple decorators to the function"}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["or, equivalently, use ",(0,s.jsx)(t.code,{children:"Route.add_endpoint"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'users_route.add_endpoint("GET", "POST", ...,  create_user)\n'})}),"\n",(0,s.jsx)(t.h2,{id:"defining-an-sub-route",children:"Defining an sub-route"}),"\n",(0,s.jsxs)(t.p,{children:["In previous discussion, we created a route for ",(0,s.jsx)(t.code,{children:"users"}),", a collection of the user resource,\nto expose an specific user resource,"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'user_route = users_route.sub("{user_id}")\n\n@user_route.get\nasync def get_user(user_id: str, limit: int = 1): ...\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Here,\nwe define a sub route of ",(0,s.jsx)(t.code,{children:"users_route"}),", when we include an route into our ",(0,s.jsx)(t.code,{children:"Lihil"}),", all of its sub-routes will also be included recursively."]}),"\n",(0,s.jsx)(t.p,{children:"Route.sub is idempotent, you might call it with the same path multiple times."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'@users_route.sub("{user_id}").get\nasync def get_user(user_id: str, limit: int = 1): ...\n\n@users_route.sub("{user_id}").put\nasync def update_user(data: UserUpdate): ...\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Here, both ",(0,s.jsx)(t.code,{children:"get_user"})," and ",(0,s.jsx)(t.code,{children:"update_user"})," are under the same route."]}),"\n",(0,s.jsx)(t.h2,{id:"the-root-route",children:"The root route"}),"\n",(0,s.jsxs)(t.p,{children:["An route with path ",(0,s.jsx)(t.code,{children:"/"})," is the root route, if not provided, root route is created with ",(0,s.jsx)(t.code,{children:"Lihil"})," by default, anything registered via ",(0,s.jsx)(t.code,{children:"Lihil.{http method}"})," is the under the root route."]}),"\n",(0,s.jsx)(t.p,{children:"The following examples are funtionality-wise the same"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["use ",(0,s.jsx)(t.code,{children:"Lihil"})," instance as the root route"]}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'lhl = Lihil()\n@lhl.get\nasync def hello():\n    return "hello, world:\n'})}),"\n",(0,s.jsxs)(t.ol,{start:"2",children:["\n",(0,s.jsxs)(t.li,{children:["create root route then include it in your ",(0,s.jsx)(t.code,{children:"Lihil"})," instance"]}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'root = Route()\n@root.get\nasync def hello():\n    return "hello, world:\nlhl = Lihil(routes=[root])\n'})})]})}function a(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);