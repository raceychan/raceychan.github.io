"use strict";(self.webpackChunkblogs=self.webpackChunkblogs||[]).push([[122],{5509:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"AdvancedUsage/auth","title":"Advanced Usage","description":"Authentification","source":"@site/docs/AdvancedUsage/auth.md","sourceDirName":"AdvancedUsage","slug":"/AdvancedUsage/auth","permalink":"/docs/AdvancedUsage/auth","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/AdvancedUsage/auth.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Installation","permalink":"/docs/tutorial"},"next":{"title":"create an endpoint","permalink":"/docs/Basics/endpoint"}}');var t=i(4848),s=i(8453);const l={},r="Advanced Usage",d={},o=[{value:"Authentification",id:"authentification",level:2},{value:"Auth header",id:"auth-header",level:3},{value:"Json Web Token",id:"json-web-token",level:3},{value:"OAuth",id:"oauth",level:3},{value:"Plugins &amp; Param Processor",id:"plugins--param-processor",level:2},{value:"Plugins",id:"plugins",level:3},{value:"Initialization",id:"initialization",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"advanced-usage",children:"Advanced Usage"})}),"\n",(0,t.jsx)(n.h2,{id:"authentification",children:"Authentification"}),"\n",(0,t.jsx)(n.h3,{id:"auth-header",children:"Auth header"}),"\n",(0,t.jsx)(n.h3,{id:"json-web-token",children:"Json Web Token"}),"\n",(0,t.jsx)(n.h3,{id:"oauth",children:"OAuth"}),"\n",(0,t.jsx)(n.h2,{id:"plugins--param-processor",children:"Plugins & Param Processor"}),"\n",(0,t.jsx)(n.h3,{id:"plugins",children:"Plugins"}),"\n",(0,t.jsx)(n.h3,{id:"initialization",children:"Initialization"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"init at lifespan"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from lihil import Graph\n\nasync def lifespan(app: Lihil):\n    async with YourPlugin() as up:\n        app.graph.register_singleton(up)\n        yield\n\nlhl = LIhil(lifespan=lifespan)\n"})}),"\n",(0,t.jsx)(n.p,{children:"use it anywhere with DI"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"init at middleware"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["plugin can be initialized and injected into middleware,\nmiddleware can be bind to different route, for example ",(0,t.jsx)(n.code,{children:"Throttle"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# pseudo code\nclass ThrottleMiddleware:\n    def __init__(self, app: Ignore[ASGIApp], redis: Redis):\n        self.app = app\n        self.redis = redis\n\n    async def __call__(self, app):\n        await self.redis.run_throttle_script\n        await self.app\n\n"})}),"\n",(0,t.jsx)(n.p,{children:"lihil accepts a factory to build your middleware, so that you can use di inside the factory, and it will perserve typing info as well. Anything callable that requires only one positonal argument can be a factory, which include most ASGI middleware classes."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"lihil.add_middleware(lambda app: app.graph.resolve(ThrottleMiddleware))\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Use it at your endpoints"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"async def create_user(user_name: str, plugin: YourPlugin): ...\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>r});var a=i(6540);const t={},s=a.createContext(t);function l(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);