<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">What to Do When HTTP Status Codes Don’t Fit Your Business Error | Lihil Official</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://lihil.cc/blog/What-to-Do-When-HTTP-Status-Codes-Don’t-Fit-Your-Business-Error"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="keywords" content="python, api, fast, webframework, web"><meta data-rh="true" property="og:title" content="What to Do When HTTP Status Codes Don’t Fit Your Business Error | Lihil Official"><meta data-rh="true" name="description" content="Question:"><meta data-rh="true" property="og:description" content="Question:"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-04-27T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/raceychan"><meta data-rh="true" property="article:tag" content="WebDevelopment"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://lihil.cc/blog/What-to-Do-When-HTTP-Status-Codes-Don’t-Fit-Your-Business-Error"><link data-rh="true" rel="alternate" href="https://lihil.cc/blog/What-to-Do-When-HTTP-Status-Codes-Don’t-Fit-Your-Business-Error" hreflang="en"><link data-rh="true" rel="alternate" href="https://lihil.cc/blog/What-to-Do-When-HTTP-Status-Codes-Don’t-Fit-Your-Business-Error" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://lihil.cc/blog/What-to-Do-When-HTTP-Status-Codes-Don’t-Fit-Your-Business-Error","mainEntityOfPage":"https://lihil.cc/blog/What-to-Do-When-HTTP-Status-Codes-Don’t-Fit-Your-Business-Error","url":"https://lihil.cc/blog/What-to-Do-When-HTTP-Status-Codes-Don’t-Fit-Your-Business-Error","headline":"What to Do When HTTP Status Codes Don’t Fit Your Business Error","name":"What to Do When HTTP Status Codes Don’t Fit Your Business Error","description":"Question:","datePublished":"2025-04-27T00:00:00.000Z","author":{"@type":"Person","name":"raceychan","description":"author of lihil, a developer.","url":"https://github.com/raceychan","image":"https://github.com/raceychan.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://lihil.cc/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Lihil Official RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Lihil Official Atom Feed"><link rel="stylesheet" href="/assets/css/styles.ffc264eb.css">
<script src="/assets/js/runtime~main.6fd8fade.js" defer="defer"></script>
<script src="/assets/js/main.434fcf42.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/lhl_logo_ts.png"><link rel="preload" as="image" href="https://github.com/raceychan.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/lhl_logo_ts.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/lhl_logo_ts.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Lihil</b></a><a class="navbar__item navbar__link" href="/docs/">Tutorial</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/raceychan/lihil" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/What-to-Do-When-HTTP-Status-Codes-Don’t-Fit-Your-Business-Error">What to Do When HTTP Status Codes Don’t Fit Your Business Error</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_xvU1">What to Do When HTTP Status Codes Don’t Fit Your Business Error</h1><div class="container_iJTo margin-vert--md"><time datetime="2025-04-27T00:00:00.000Z">April 27, 2025</time> · <!-- -->17 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_q4o9"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/blog/authors/raceychan"><img class="avatar__photo authorImage_XqGP" src="https://github.com/raceychan.png" alt="raceychan"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/blog/authors/raceychan"><span class="authorName_yefp">raceychan</span></a></div><small class="authorTitle_nd0D" title="author of lihil, a developer.">author of lihil, a developer.</small><div class="authorSocials_rSDt"><a href="https://x.com/raceychan" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="X"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="none" viewBox="0 0 1200 1227" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf xSvg_y3PF"><path d="M714.163 519.284 1160.89 0h-105.86L667.137 450.887 357.328 0H0l468.492 681.821L0 1226.37h105.866l409.625-476.152 327.181 476.152H1200L714.137 519.284h.026ZM569.165 687.828l-47.468-67.894-377.686-540.24h162.604l304.797 435.991 47.468 67.894 396.2 566.721H892.476L569.165 687.854v-.026Z"></path></svg></a><a href="https://github.com/raceychan" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="question">Question:<a href="#question" class="hash-link" aria-label="Direct link to Question:" title="Direct link to Question:">​</a></h3>
<p><strong>How would you choose a status code for an order that could not be processed because the customer&#x27;s shipping address is outside the delivery zone?</strong></p>
<p>HTTP status codes have long been a cornerstone of web application error handling. Defined in RFC 7231, these codes serve as a standardized way for servers to communicate the outcome of a request to the client. The standard defines several categories of status codes, such as <code>2xx</code> for success, <code>4xx</code> for client errors, and <code>5xx</code> for server errors.</p>
<p>Quote from <a href="https://datatracker.ietf.org/doc/html/rfc7231#section-8.2.2" target="_blank" rel="noopener noreferrer">RFC 7231</a>:</p>
<blockquote>
<p>HTTP clients are not required to
understand the meaning of all registered status codes, though such
understanding is obviously desirable.  However, a client MUST
understand the class of any status code, as indicated by the first
digit, and treat an unrecognized status code as being equivalent to
the x00 status code of that class</p>
</blockquote>
<p>It has become an industrial consensus to check these status codes as a way to quickly determine whether a request was successful or failed. For example, many libraries and frameworks will raise an exception if a request results in an error status. Here&#x27;s a simple example using Python&#x27;s <code>requests</code> library:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2E3440;--prism-color:#D8DEE9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="background-color:#2E3440;color:#D8DEE9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D8DEE9"><span class="token keyword" style="color:#81A1C1">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">response </span><span class="token operator" style="color:#81A1C1">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token string" style="color:#A3BE8C">&quot;https://api.example.com/data&quot;</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">response</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">raise_for_status</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"> </span><span class="token comment" style="color:#4C566A;font-style:italic"># this would raise exception when status code &gt; 400</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token keyword" style="color:#81A1C1">print</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token string" style="color:#A3BE8C">&quot;Data retrieved successfully!&quot;</span><span class="token punctuation" style="color:#8FBCBB">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>In this example, <code>raise_for_status()</code> automatically raises an <code>HTTPError</code> if the server returns a 4xx or 5xx status code. This is a common pattern in many applications to ensure that only successful requests are processed further.</p>
</blockquote>
<p>For business logic errors, it&#x27;s common to use <code>4xx</code> codes like <code>400 Bad Request</code> or <code>403 Forbidden</code> when something goes wrong. For example, a &quot;premium&quot; user trying to access a feature available only to &quot;pro&quot; users might return a <code>403 Forbidden</code> status. In such cases, the error is clear, and the status code maps well to the scenario.</p>
<p>But as web applications grow in complexity and deal with more nuanced business rules, things get trickier. Consider a scenario where <strong>an order could not be processed because of a mismatch between the customer&#x27;s shipping address and the delivery zone</strong>. How should this issue be represented in terms of HTTP status codes?</p>
<p>There isn&#x27;t an easy or clear answer. While we could use <code>400 Bad Request</code>, it doesn&#x27;t quite capture the specific business rule violation that&#x27;s occurring. Similarly, a <code>409 Conflict</code> could work in some cases, but it still doesn’t feel precise enough. As the number of potential issues grows—whether they’re related to payment failures, address mismatches, or resource conflicts—the more apparent it becomes that HTTP status codes are not built to handle the full complexity of modern business logic.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-do-people-do">What Do People Do?<a href="#what-do-people-do" class="hash-link" aria-label="Direct link to What Do People Do?" title="Direct link to What Do People Do?">​</a></h3>
<p>Currently, there are a few ways the industry deals with the problem of handling business logic errors in web applications. These solutions often involve workarounds or generalizations due to the limitations of HTTP status codes. Here are some of the common approaches:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="bad">Bad<a href="#bad" class="hash-link" aria-label="Direct link to Bad" title="Direct link to Bad">​</a></h4>
<ol>
<li><strong>Embedding Custom Status Inside Request Body</strong></li>
</ol>
<p>One approach is to always return a <code>200 OK</code> status code, even when the request fails, and include a custom status code in the response body. This method involves returning a business-specific error code along with additional details.</p>
<p><strong>Example</strong>:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2E3440;--prism-color:#D8DEE9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="background-color:#2E3440;color:#D8DEE9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D8DEE9"><span class="token plain">   </span><span class="token punctuation" style="color:#8FBCBB">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">       </span><span class="token property">&quot;business_code&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;CUSTOMIZED_BUSINESS_ERROR&quot;</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">       </span><span class="token property">&quot;detail&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;The shipping address is outside the serviceable delivery zone.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">   </span><span class="token punctuation" style="color:#8FBCBB">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>I have personally encountered this solution from my work a several times during my career. when the system contains only a few components, and with detailed documentation, it could work, but as the system grows and additional components (like proxies, API gateways, and logging systems) are added, this keeps creating new problems you wouldn&#x27;t have to solve otherwise.</p>
<ol start="2">
<li>self-define 3-digits status code, for example, 6xx means some business rules, 700 means others, etc.</li>
</ol>
<p>Some solutions attempt to define their own set of status codes beyond the standard <code>2xx</code>, <code>4xx</code>, and <code>5xx</code> categories. For example, <code>6xx</code> might represent business rules, with specific codes for each scenario (e.g., <code>700</code> for some other business logic).</p>
<p><strong>Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2E3440;--prism-color:#D8DEE9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="background-color:#2E3440;color:#D8DEE9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D8DEE9"><span class="token number" style="color:#81A1C1">600</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> CONNECTION ERROR </span><span class="token operator" style="color:#81A1C1">-</span><span class="token plain"> This indicates a general connection error</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token number" style="color:#81A1C1">601</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> INCOMPLETE ERROR </span><span class="token operator" style="color:#81A1C1">-</span><span class="token plain"> This indicates sever sends an incomplete page</span><span class="token operator" style="color:#81A1C1">/</span><span class="token builtin" style="color:#8FBCBB">object</span><span class="token plain"> </span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token keyword" style="color:#81A1C1">as</span><span class="token plain"> indicated by Content</span><span class="token operator" style="color:#81A1C1">-</span><span class="token plain">Length header</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token number" style="color:#81A1C1">701</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> ERROR TEXT FOUND </span><span class="token operator" style="color:#81A1C1">-</span><span class="token plain"> This code </span><span class="token keyword" style="color:#81A1C1">is</span><span class="token plain"> returned </span><span class="token keyword" style="color:#81A1C1">if</span><span class="token plain"> </span><span class="token builtin" style="color:#8FBCBB">any</span><span class="token plain"> error text </span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">such </span><span class="token keyword" style="color:#81A1C1">as</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;Service Unavailable&quot;</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"> are found </span><span class="token keyword" style="color:#81A1C1">in</span><span class="token plain"> the main page </span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">frame HTML contents included</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain"> Note that the error text must be defined </span><span class="token keyword" style="color:#81A1C1">in</span><span class="token plain"> advance of the test</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain"> Error text means </span><span class="token keyword" style="color:#81A1C1">if</span><span class="token plain"> the text </span><span class="token keyword" style="color:#81A1C1">is</span><span class="token plain"> found</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> this session should be considered a failure</span><span class="token punctuation" style="color:#8FBCBB">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>While this avoids reading the request body to determine failure, it violates the HTTP standards, meaning many tools might throw errors or not support these codes.
According to <a href="https://datatracker.ietf.org/doc/html/rfc7231#section-8.2.2" target="_blank" rel="noopener noreferrer">RFC 7231</a></p>
<blockquote>
<p>New status codes are required to fall under one of the categories
defined in <a href="https://datatracker.ietf.org/doc/html/rfc7231#section-6" target="_blank" rel="noopener noreferrer">Section 6</a>.</p>
</blockquote>
<p>status codes &gt;= 600 are invalid because they fall outside of the defined categories.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ok">OK<a href="#ok" class="hash-link" aria-label="Direct link to OK" title="Direct link to OK">​</a></h4>
<ol>
<li><strong>A 4xx status code + Generic Error Message</strong><br>
<!-- -->A common fallback is to return a <code>4xx</code> status code (typically <code>400 Bad Request</code>) and include a generic error message such as &quot;Something went wrong&quot; in the response body.</li>
</ol>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2E3440;--prism-color:#D8DEE9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="background-color:#2E3440;color:#D8DEE9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D8DEE9"><span class="token punctuation" style="color:#8FBCBB">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">  </span><span class="token property">&quot;status&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token number" style="color:#81A1C1">400</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">  </span><span class="token property">&quot;message&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;Something went wrong&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token punctuation" style="color:#8FBCBB">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This approach hides the real cause of the business logic failure and lumps all client errors into one vague category. While this might suffice for small-scale applications or early prototypes, it quickly becomes inadequate as the complexity of business rules increases.</p>
<p>Some systems go a step further by returning a one-line reason phrase or a slightly extended message, but still fall short of conveying structured, actionable error details to clients.</p>
<ol start="2">
<li><strong>Using the Same Status Code for Multiple Business Logic Issues</strong></li>
</ol>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2E3440;--prism-color:#D8DEE9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="background-color:#2E3440;color:#D8DEE9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D8DEE9"><span class="token punctuation" style="color:#8FBCBB">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">  </span><span class="token property">&quot;status&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token number" style="color:#81A1C1">400</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">  </span><span class="token property">&quot;message&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;Payment failed&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token punctuation" style="color:#8FBCBB">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token punctuation" style="color:#8FBCBB">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">  </span><span class="token property">&quot;status&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token number" style="color:#81A1C1">400</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">  </span><span class="token property">&quot;message&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;Invalid shipping address&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token punctuation" style="color:#8FBCBB">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As business logic errors grow in number and variety, some teams attempt to fit them into a limited set of existing status codes. For instance, both a payment failure due to insufficient funds and a mismatch in shipping address might be returned as <code>400 Bad Request</code>. While this approach simplifies server-side handling, it severely limits the clarity of error messages, making it hard for clients to distinguish between different types of business failures. This also places unnecessary burden on client-side developers to reverse-engineer the true nature of the error from vague responses.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="good">Good<a href="#good" class="hash-link" aria-label="Direct link to Good" title="Direct link to Good">​</a></h4>
<p><strong>Structured Error Message + Documentation (With Standards Compliance)</strong></p>
<p>A thoughtful approach to business rule violations is to return an appropriate <code>4xx</code> status code—ideally one that aligns semantically with the error (for example, <code>407 Proxy Authentication Required</code>, if applicable)—to indicate that the request was unsuccessful due to a business constraint.</p>
<p>In addition, the response body can include a <strong>structured error message</strong> based on <a href="https://datatracker.ietf.org/doc/html/rfc9457" target="_blank" rel="noopener noreferrer">RFC 9457 (Problem Details for HTTP APIs)</a>, which defines fields such as <code>type</code>, <code>title</code>, <code>status</code>, <code>detail</code>, and <code>instance</code>. This format encourages clarity and consistency, making it easier for both developers and automated systems to understand, handle, and trace errors.</p>
<p>Equally important is having each error type <strong>clearly documented</strong> so that client developers know what an error means and how to address it. Well-maintained documentation enables richer client experiences, reduces guesswork, and helps prevent issues before they arise.</p>
<p>Stripe does an excellent job in this area with their <a href="https://docs.stripe.com/error-codes" target="_blank" rel="noopener noreferrer">dedicated error code documentation</a>, which provides detailed explanations for a wide range of business-related errors. Their commitment to transparency and developer experience is evident and commendable.</p>
<p>That said, there are a couple of areas where further improvements could enhance the experience even more:</p>
<ul>
<li>Their structured error format, while clear, doesn’t explicitly follow RFC 9457, and omits fields like <code>instance</code> that can be valuable for debugging.</li>
<li>It’s not clear whether their documentation is automatically generated or manually maintained. If it’s the latter, this could introduce challenges in keeping it fully up to date with evolving APIs.</li>
</ul>
<p>Still, Stripe&#x27;s approach represents a strong foundation. By building on this with standards-based structures and automation, error handling can become even more predictable, maintainable, and user-friendly.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-lihil-solves-this-problem">How lihil solves this problem<a href="#how-lihil-solves-this-problem" class="hash-link" aria-label="Direct link to How lihil solves this problem" title="Direct link to How lihil solves this problem">​</a></h3>
<p><strong>Structured Error Messages + Auto-Generated Documentation</strong></p>
<p><code>lihil</code> tackles the problem by making structured error handling first-class. You can declare rich, type-safe exceptions by subclassing <code>HTTPException[T]</code>, where <code>T</code> defines the structure of the error&#x27;s <code>detail</code> field. These exceptions can then be directly attached to endpoints using the <code>errors=</code> parameter. This not only ensures consistent error responses but also enables <code>lihil</code> to automatically generate OpenAPI documentation for each declared error—including a link to a detailed problem page under the &quot;External documentation&quot; tab.</p>
<p>Every error response follows the <a href="https://datatracker.ietf.org/doc/html/rfc9457" target="_blank" rel="noopener noreferrer">RFC 9457</a> format, including fields like <code>type</code>, <code>title</code>, <code>status</code>, <code>detail</code>, and <code>instance</code>. You can customize how errors are rendered by registering handlers with <code>@problem_solver</code>, which maps specific exceptions or status codes to structured responses. Specific exception handlers take precedence over status-code-based ones, giving you fine-grained control.</p>
<p>By default, <code>lihil</code> also generates detailed responses for common issues such as missing parameters, returning structured 422 responses for <code>InvalidRequestErrors</code>—complete with field-level information. These responses are not only machine-readable but also fully documented out of the box.</p>
<p>Best of all, all this documentation is automatically synced with your code. There&#x27;s no need to manually update or maintain a separate error code reference. <code>lihil</code> keeps your API behavior and documentation in perfect alignment.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2E3440;--prism-color:#D8DEE9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="background-color:#2E3440;color:#D8DEE9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D8DEE9"><span class="token keyword" style="color:#81A1C1">from</span><span class="token plain"> lihil </span><span class="token keyword" style="color:#81A1C1">import</span><span class="token plain"> Empty</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Lihil</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Resp</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Route</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> status</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Meta</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token keyword" style="color:#81A1C1">from</span><span class="token plain"> lihil</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">interface </span><span class="token keyword" style="color:#81A1C1">import</span><span class="token plain"> Base</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token keyword" style="color:#81A1C1">from</span><span class="token plain"> lihil</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">problems </span><span class="token keyword" style="color:#81A1C1">import</span><span class="token plain"> HTTPException</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token keyword" style="color:#81A1C1">class</span><span class="token plain"> </span><span class="token class-name" style="color:#8FBCBB">AddressOutOfScopeProblem</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">Base</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    current_address</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> Annotated</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token builtin" style="color:#8FBCBB">str</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Meta</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">examples</span><span class="token operator" style="color:#81A1C1">=</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token string" style="color:#A3BE8C">&quot;home&quot;</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    service_radius</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> Annotated</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token builtin" style="color:#8FBCBB">float</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Meta</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">examples</span><span class="token operator" style="color:#81A1C1">=</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token number" style="color:#81A1C1">3.5</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    distance</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> Annotated</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token builtin" style="color:#8FBCBB">float</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Meta</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">examples</span><span class="token operator" style="color:#81A1C1">=</span><span class="token number" style="color:#81A1C1">4</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    message</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> </span><span class="token builtin" style="color:#8FBCBB">str</span><span class="token plain"> </span><span class="token operator" style="color:#81A1C1">=</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    </span><span class="token keyword" style="color:#81A1C1">def</span><span class="token plain"> </span><span class="token function" style="color:#88C0D0">__post_init__</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">        self</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">message </span><span class="token operator" style="color:#81A1C1">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#A3BE8C">f&quot;Your current address </span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">.</span><span class="token string-interpolation interpolation">current_address</span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">}</span><span class="token string-interpolation string" style="color:#A3BE8C"> is </span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">.</span><span class="token string-interpolation interpolation">distance</span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">}</span><span class="token string-interpolation string" style="color:#A3BE8C"> miles away and our service radius is </span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">.</span><span class="token string-interpolation interpolation">service_radius</span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">}</span><span class="token string-interpolation string" style="color:#A3BE8C">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token keyword" style="color:#81A1C1">class</span><span class="token plain"> </span><span class="token class-name" style="color:#8FBCBB">InvalidOrderError</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">HTTPException</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token plain">AddressOutOfScopeProblem</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    </span><span class="token string" style="color:#A3BE8C">&quot;Address out of service zone&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    __status__ </span><span class="token operator" style="color:#81A1C1">=</span><span class="token plain"> </span><span class="token number" style="color:#81A1C1">422</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    instance</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> Annotated</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token builtin" style="color:#8FBCBB">str</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Meta</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">examples</span><span class="token operator" style="color:#81A1C1">=</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token string" style="color:#A3BE8C">&quot;2cd20e0c-9ddc-4fdc-8f61-b32f62ac784d&quot;</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    detail</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> AddressOutOfScopeProblem</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">orders </span><span class="token operator" style="color:#81A1C1">=</span><span class="token plain"> Route</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token string" style="color:#A3BE8C">&quot;orders&quot;</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#8FBCBB">@orders</span><span class="token decorator annotation punctuation" style="color:#8FBCBB">.</span><span class="token decorator annotation punctuation" style="color:#8FBCBB">post</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">errors</span><span class="token operator" style="color:#81A1C1">=</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token plain">InvalidOrderError</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token keyword" style="color:#81A1C1">async</span><span class="token plain"> </span><span class="token keyword" style="color:#81A1C1">def</span><span class="token plain"> </span><span class="token function" style="color:#88C0D0">create_orders</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"> </span><span class="token operator" style="color:#81A1C1">-</span><span class="token operator" style="color:#81A1C1">&gt;</span><span class="token plain"> Resp</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token plain">Empty</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> status</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">CREATED</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">lhl </span><span class="token operator" style="color:#81A1C1">=</span><span class="token plain"> Lihil</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">routes</span><span class="token operator" style="color:#81A1C1">=</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token plain">orders</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token keyword" style="color:#81A1C1">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#81A1C1">==</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;__main__&quot;</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    lhl</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">__file__</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">```The problem</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token operator" style="color:#81A1C1">**</span><span class="token plain">Finite number of status code vs infinite numer of  business errors</span><span class="token operator" style="color:#81A1C1">**</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token operator" style="color:#81A1C1">&lt;</span><span class="token plain">!</span><span class="token operator" style="color:#81A1C1">-</span><span class="token operator" style="color:#81A1C1">-</span><span class="token plain"> truncate </span><span class="token operator" style="color:#81A1C1">-</span><span class="token operator" style="color:#81A1C1">-</span><span class="token operator" style="color:#81A1C1">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">HTTP status codes have </span><span class="token builtin" style="color:#8FBCBB">long</span><span class="token plain"> been a cornerstone of web application error handling</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain"> Defined </span><span class="token keyword" style="color:#81A1C1">in</span><span class="token plain"> RFC </span><span class="token number" style="color:#81A1C1">7231</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> these codes serve </span><span class="token keyword" style="color:#81A1C1">as</span><span class="token plain"> a standardized way </span><span class="token keyword" style="color:#81A1C1">for</span><span class="token plain"> servers to communicate the outcome of a request to the client</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain"> The standard defines several categories of status codes</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> such </span><span class="token keyword" style="color:#81A1C1">as</span><span class="token plain"> `2xx` </span><span class="token keyword" style="color:#81A1C1">for</span><span class="token plain"> success</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> `4xx` </span><span class="token keyword" style="color:#81A1C1">for</span><span class="token plain"> client errors</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> </span><span class="token keyword" style="color:#81A1C1">and</span><span class="token plain"> `5xx` </span><span class="token keyword" style="color:#81A1C1">for</span><span class="token plain"> server errors</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">Quote </span><span class="token keyword" style="color:#81A1C1">from</span><span class="token plain"> </span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token plain">RFC </span><span class="token number" style="color:#81A1C1">7231</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">https</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token operator" style="color:#81A1C1">//</span><span class="token plain">datatracker</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">ietf</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">org</span><span class="token operator" style="color:#81A1C1">/</span><span class="token plain">doc</span><span class="token operator" style="color:#81A1C1">/</span><span class="token plain">html</span><span class="token operator" style="color:#81A1C1">/</span><span class="token plain">rfc7231</span><span class="token comment" style="color:#4C566A;font-style:italic">#section-8.2.2):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token operator" style="color:#81A1C1">&gt;</span><span class="token plain"> HTTP clients are </span><span class="token keyword" style="color:#81A1C1">not</span><span class="token plain"> required to</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">   understand the meaning of </span><span class="token builtin" style="color:#8FBCBB">all</span><span class="token plain"> registered status codes</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> though such</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">   understanding </span><span class="token keyword" style="color:#81A1C1">is</span><span class="token plain"> obviously desirable</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">  However</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> a client MUST</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">   understand the </span><span class="token keyword" style="color:#81A1C1">class</span><span class="token plain"> </span><span class="token class-name" style="color:#8FBCBB">of</span><span class="token plain"> </span><span class="token builtin" style="color:#8FBCBB">any</span><span class="token plain"> status code</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> </span><span class="token keyword" style="color:#81A1C1">as</span><span class="token plain"> indicated by the first</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">   digit</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> </span><span class="token keyword" style="color:#81A1C1">and</span><span class="token plain"> treat an unrecognized status code </span><span class="token keyword" style="color:#81A1C1">as</span><span class="token plain"> being equivalent to</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">   the x00 status code of that </span><span class="token keyword" style="color:#81A1C1">class</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token class-name" style="color:#8FBCBB">It</span><span class="token plain"> has become an industrial consensus to check these status codes </span><span class="token keyword" style="color:#81A1C1">as</span><span class="token plain"> a way to quickly determine whether a request was successful </span><span class="token keyword" style="color:#81A1C1">or</span><span class="token plain"> failed</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain"> For example</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> many libraries </span><span class="token keyword" style="color:#81A1C1">and</span><span class="token plain"> frameworks will </span><span class="token keyword" style="color:#81A1C1">raise</span><span class="token plain"> an exception </span><span class="token keyword" style="color:#81A1C1">if</span><span class="token plain"> a request results </span><span class="token keyword" style="color:#81A1C1">in</span><span class="token plain"> an error status</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain"> Here</span><span class="token string" style="color:#A3BE8C">&#x27;s a simple example using Python&#x27;</span><span class="token plain">s `requests` library</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token keyword" style="color:#81A1C1">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">response </span><span class="token operator" style="color:#81A1C1">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token string" style="color:#A3BE8C">&quot;https://api.example.com/data&quot;</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">response</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">raise_for_status</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"> </span><span class="token comment" style="color:#4C566A;font-style:italic"># this would raise exception when status code &gt; 400</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token keyword" style="color:#81A1C1">print</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token string" style="color:#A3BE8C">&quot;Data retrieved successfully!&quot;</span><span class="token punctuation" style="color:#8FBCBB">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>In this example, <code>raise_for_status()</code> automatically raises an <code>HTTPError</code> if the server returns a 4xx or 5xx status code. This is a common pattern in many applications to ensure that only successful requests are processed further.</p>
</blockquote>
<p>For business logic errors, it&#x27;s common to use <code>4xx</code> codes like <code>400 Bad Request</code> or <code>403 Forbidden</code> when something goes wrong. For example, a &quot;premium&quot; user trying to access a feature available only to &quot;pro&quot; users might return a <code>403 Forbidden</code> status. In such cases, the error is clear, and the status code maps well to the scenario.</p>
<p>But as web applications grow in complexity and deal with more nuanced business rules, things get trickier. Consider a scenario where <strong>an order could not be processed because of the customer&#x27;s shipping address is out of the delivery zone</strong>. How should this issue be represented in terms of HTTP status codes?</p>
<p>There isn&#x27;t an easy or clear answer. While we could use <code>400 Bad Request</code>, it doesn&#x27;t quite capture the specific business rule violation that&#x27;s occurring. Similarly, a <code>409 Conflict</code> could work in some cases, but it still doesn’t feel precise enough. As the number of potential issues grows—whether they’re related to payment failures, address mismatches, or resource conflicts—the more apparent it becomes that HTTP status codes are not built to handle the full complexity of modern business logic.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-do-people-do-1">What Do People Do?<a href="#what-do-people-do-1" class="hash-link" aria-label="Direct link to What Do People Do?" title="Direct link to What Do People Do?">​</a></h3>
<p>Currently, there are a few ways the industry deals with the problem of handling business logic errors in web applications. These solutions often involve workarounds or generalizations due to the limitations of HTTP status codes. Here are some of the common approaches:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="bad-1">Bad<a href="#bad-1" class="hash-link" aria-label="Direct link to Bad" title="Direct link to Bad">​</a></h4>
<ol>
<li><strong>Embedding Custom Status Inside Request Body</strong></li>
</ol>
<p>One approach is to always return a <code>200 OK</code> status code, even when the request fails, and include a custom status code in the response body. This method involves returning a business-specific error code along with additional details.</p>
<p><strong>Example</strong>:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2E3440;--prism-color:#D8DEE9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="background-color:#2E3440;color:#D8DEE9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D8DEE9"><span class="token plain">   </span><span class="token punctuation" style="color:#8FBCBB">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">       </span><span class="token property">&quot;business_code&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;CUSTOMIZED_BUSINESS_ERROR&quot;</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">       </span><span class="token property">&quot;detail&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;The shipping address is outside the serviceable delivery zone.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">   </span><span class="token punctuation" style="color:#8FBCBB">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>I have personally encountered this solution from my work a several times during my career. when the system contains only a few components, and with detailed documentation, it could work, but as the system grows and additional components (like proxies, API gateways, and logging systems) are added, this keeps creating new problems you wouldn&#x27;t have to solve otherwise.</p>
<ol start="2">
<li>self-define 3-digits status code, for example, 6xx means some business rules, 700 means others, etc.</li>
</ol>
<p>Some solutions attempt to define their own set of status codes beyond the standard <code>2xx</code>, <code>4xx</code>, and <code>5xx</code> categories. For example, <code>6xx</code> might represent business rules, with specific codes for each scenario (e.g., <code>700</code> for some other business logic). While this avoids reading the request body to determine failure, it violates the HTTP standards, meaning many tools might throw errors or not support these codes.
<strong>Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2E3440;--prism-color:#D8DEE9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="background-color:#2E3440;color:#D8DEE9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D8DEE9"><span class="token number" style="color:#81A1C1">600</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> CONNECTION ERROR </span><span class="token operator" style="color:#81A1C1">-</span><span class="token plain"> This indicates a general connection error</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token number" style="color:#81A1C1">601</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> INCOMPLETE ERROR </span><span class="token operator" style="color:#81A1C1">-</span><span class="token plain"> This indicates sever sends an incomplete page</span><span class="token operator" style="color:#81A1C1">/</span><span class="token builtin" style="color:#8FBCBB">object</span><span class="token plain"> </span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token keyword" style="color:#81A1C1">as</span><span class="token plain"> indicated by Content</span><span class="token operator" style="color:#81A1C1">-</span><span class="token plain">Length header</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token number" style="color:#81A1C1">701</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> ERROR TEXT FOUND </span><span class="token operator" style="color:#81A1C1">-</span><span class="token plain"> This code </span><span class="token keyword" style="color:#81A1C1">is</span><span class="token plain"> returned </span><span class="token keyword" style="color:#81A1C1">if</span><span class="token plain"> </span><span class="token builtin" style="color:#8FBCBB">any</span><span class="token plain"> error text </span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">such </span><span class="token keyword" style="color:#81A1C1">as</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;Service Unavailable&quot;</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"> are found </span><span class="token keyword" style="color:#81A1C1">in</span><span class="token plain"> the main page </span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">frame HTML contents included</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain"> Note that the error text must be defined </span><span class="token keyword" style="color:#81A1C1">in</span><span class="token plain"> advance of the test</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain"> Error text means </span><span class="token keyword" style="color:#81A1C1">if</span><span class="token plain"> the text </span><span class="token keyword" style="color:#81A1C1">is</span><span class="token plain"> found</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> this session should be considered a failure</span><span class="token punctuation" style="color:#8FBCBB">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>According to <a href="https://datatracker.ietf.org/doc/html/rfc7231#section-8.2.2" target="_blank" rel="noopener noreferrer">RFC 7231</a>,</p>
<blockquote>
<p>New status codes are required to fall under one of the categories
defined in <a href="https://datatracker.ietf.org/doc/html/rfc7231#section-6" target="_blank" rel="noopener noreferrer">Section 6</a>.</p>
</blockquote>
<p>status codes &gt;= 600 are invalid because they fall outside of the defined categories.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ok-1">OK<a href="#ok-1" class="hash-link" aria-label="Direct link to OK" title="Direct link to OK">​</a></h4>
<ol>
<li><strong>A 4xx status code + Generic Error Message</strong></li>
</ol>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2E3440;--prism-color:#D8DEE9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="background-color:#2E3440;color:#D8DEE9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D8DEE9"><span class="token punctuation" style="color:#8FBCBB">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">  </span><span class="token property">&quot;status&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token number" style="color:#81A1C1">400</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">  </span><span class="token property">&quot;message&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;Something went wrong&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token punctuation" style="color:#8FBCBB">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>A common fallback is to return a <code>4xx</code> status code (typically <code>400 Bad Request</code>) and include a generic error message such as &quot;Something went wrong&quot; in the response body. This approach hides the real cause of the business logic failure and lumps all client errors into one vague category. While this might suffice for small-scale applications or early prototypes, it quickly becomes inadequate as the complexity of business rules increases.</p>
<p>Some systems go a step further by returning a one-line reason phrase or a slightly extended message, but still fall short of conveying structured, actionable error details to clients.</p>
<ol start="2">
<li><strong>Using the Same Status Code for Multiple Business Logic Issues</strong></li>
</ol>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2E3440;--prism-color:#D8DEE9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="background-color:#2E3440;color:#D8DEE9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D8DEE9"><span class="token punctuation" style="color:#8FBCBB">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">  </span><span class="token property">&quot;status&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token number" style="color:#81A1C1">400</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">  </span><span class="token property">&quot;message&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;Payment failed&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token punctuation" style="color:#8FBCBB">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token punctuation" style="color:#8FBCBB">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">  </span><span class="token property">&quot;status&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token number" style="color:#81A1C1">400</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">  </span><span class="token property">&quot;message&quot;</span><span class="token operator" style="color:#81A1C1">:</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;Invalid shipping address&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token punctuation" style="color:#8FBCBB">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As business logic errors grow in number and variety, some teams attempt to fit them into a limited set of existing status codes. For instance, both a payment failure due to insufficient funds and a mismatch in shipping address might be returned as <code>400 Bad Request</code>. While this approach simplifies server-side handling, it severely limits the clarity of error messages, making it hard for clients to distinguish between different types of business failures. This also places unnecessary burden on client-side developers to reverse-engineer the true nature of the error from vague responses.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="good-1">Good<a href="#good-1" class="hash-link" aria-label="Direct link to Good" title="Direct link to Good">​</a></h4>
<p><strong>Structured Error Message + Documentation (With Standards Compliance)</strong></p>
<p>A thoughtful approach to business rule violations is to return an appropriate <code>4xx</code> status code—ideally one that aligns semantically with the error (for example, <code>407 Proxy Authentication Required</code>, if applicable)—to indicate that the request was unsuccessful due to a business constraint.</p>
<p>In addition, the response body can include a <strong>structured error message</strong> based on <a href="https://datatracker.ietf.org/doc/html/rfc9457" target="_blank" rel="noopener noreferrer">RFC 9457 (Problem Details for HTTP APIs)</a>, which defines fields such as <code>type</code>, <code>title</code>, <code>status</code>, <code>detail</code>, and <code>instance</code>. This format encourages clarity and consistency, making it easier for both developers and automated systems to understand, handle, and trace errors.</p>
<p>Equally important is having each error type <strong>clearly documented</strong> so that client developers know what an error means and how to address it. Well-maintained documentation enables richer client experiences, reduces guesswork, and helps prevent issues before they arise.</p>
<p>Stripe does an excellent job in this area with their <a href="https://docs.stripe.com/error-codes" target="_blank" rel="noopener noreferrer">dedicated error code documentation</a>, which provides detailed explanations for a wide range of business-related errors. Their commitment to transparency and developer experience is evident and commendable.</p>
<p>That said, there are a couple of areas where further improvements could enhance the experience even more:</p>
<ul>
<li>
<p>Their structured error format, while clear, doesn’t explicitly follow RFC 9457, and omits fields like <code>instance</code> that can be valuable for debugging.</p>
</li>
<li>
<p>It’s not clear whether their documentation is automatically generated or manually maintained. If it’s the latter, this could introduce challenges in keeping it fully up to date with evolving APIs.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-lihil-solves-this-problem-1">How lihil solves this problem<a href="#how-lihil-solves-this-problem-1" class="hash-link" aria-label="Direct link to How lihil solves this problem" title="Direct link to How lihil solves this problem">​</a></h3>
<p><strong>Structured Error Messages + Auto-Generated Documentation</strong></p>
<p><code>lihil</code> tackles the problem by making structured error handling first-class. You can declare rich, type-safe exceptions by subclassing <code>HTTPException[T]</code>, where <code>T</code> defines the structure of the error&#x27;s <code>detail</code> field. These exceptions can then be directly attached to endpoints using the <code>errors=</code> parameter. This not only ensures consistent error responses but also enables <code>lihil</code> to automatically generate OpenAPI documentation for each declared error—including a link to a detailed problem page under the &quot;External documentation&quot; tab.</p>
<p>Every error response follows the <a href="https://datatracker.ietf.org/doc/html/rfc9457" target="_blank" rel="noopener noreferrer">RFC 9457</a> format, including fields like <code>type</code>, <code>title</code>, <code>status</code>, <code>detail</code>, and <code>instance</code>. You can customize how errors are rendered by registering handlers with <code>@problem_solver</code>, which maps specific exceptions or status codes to structured responses. Specific exception handlers take precedence over status-code-based ones, giving you fine-grained control.</p>
<p>By default, <code>lihil</code> also generates detailed responses for common issues such as missing parameters, returning structured 422 responses for <code>InvalidRequestErrors</code>—complete with field-level information. These responses are not only machine-readable but also fully documented out of the box.</p>
<p>Best of all, all this documentation is automatically synced with your code. There&#x27;s no need to manually update or maintain a separate error code reference. <code>lihil</code> keeps your API behavior and documentation in perfect alignment.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2E3440;--prism-color:#D8DEE9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="background-color:#2E3440;color:#D8DEE9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D8DEE9"><span class="token keyword" style="color:#81A1C1">from</span><span class="token plain"> lihil </span><span class="token keyword" style="color:#81A1C1">import</span><span class="token plain"> Empty</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Lihil</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Resp</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Route</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> status</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Meta</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token keyword" style="color:#81A1C1">from</span><span class="token plain"> lihil</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">interface </span><span class="token keyword" style="color:#81A1C1">import</span><span class="token plain"> Base</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token keyword" style="color:#81A1C1">from</span><span class="token plain"> lihil</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">problems </span><span class="token keyword" style="color:#81A1C1">import</span><span class="token plain"> HTTPException</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token keyword" style="color:#81A1C1">class</span><span class="token plain"> </span><span class="token class-name" style="color:#8FBCBB">AddressOutOfScopeProblem</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">Base</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    current_address</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> Annotated</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token builtin" style="color:#8FBCBB">str</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Meta</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">examples</span><span class="token operator" style="color:#81A1C1">=</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token string" style="color:#A3BE8C">&quot;home&quot;</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    service_radius</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> Annotated</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token builtin" style="color:#8FBCBB">float</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Meta</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">examples</span><span class="token operator" style="color:#81A1C1">=</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token number" style="color:#81A1C1">3.5</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    distance</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> Annotated</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token builtin" style="color:#8FBCBB">float</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Meta</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">examples</span><span class="token operator" style="color:#81A1C1">=</span><span class="token number" style="color:#81A1C1">4</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    message</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> </span><span class="token builtin" style="color:#8FBCBB">str</span><span class="token plain"> </span><span class="token operator" style="color:#81A1C1">=</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    </span><span class="token keyword" style="color:#81A1C1">def</span><span class="token plain"> </span><span class="token function" style="color:#88C0D0">__post_init__</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">        self</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">message </span><span class="token operator" style="color:#81A1C1">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#A3BE8C">f&quot;Your current address </span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">.</span><span class="token string-interpolation interpolation">current_address</span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">}</span><span class="token string-interpolation string" style="color:#A3BE8C"> is </span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">.</span><span class="token string-interpolation interpolation">distance</span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">}</span><span class="token string-interpolation string" style="color:#A3BE8C"> miles away and our service radius is </span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">.</span><span class="token string-interpolation interpolation">service_radius</span><span class="token string-interpolation interpolation punctuation" style="color:#8FBCBB">}</span><span class="token string-interpolation string" style="color:#A3BE8C">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token keyword" style="color:#81A1C1">class</span><span class="token plain"> </span><span class="token class-name" style="color:#8FBCBB">InvalidOrderError</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">HTTPException</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token plain">AddressOutOfScopeProblem</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    </span><span class="token string" style="color:#A3BE8C">&quot;Address out of service zone&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    __status__ </span><span class="token operator" style="color:#81A1C1">=</span><span class="token plain"> </span><span class="token number" style="color:#81A1C1">422</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    instance</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> Annotated</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token builtin" style="color:#8FBCBB">str</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> Meta</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">examples</span><span class="token operator" style="color:#81A1C1">=</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token string" style="color:#A3BE8C">&quot;2cd20e0c-9ddc-4fdc-8f61-b32f62ac784d&quot;</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    detail</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> AddressOutOfScopeProblem</span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">orders </span><span class="token operator" style="color:#81A1C1">=</span><span class="token plain"> Route</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token string" style="color:#A3BE8C">&quot;orders&quot;</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#8FBCBB">@orders</span><span class="token decorator annotation punctuation" style="color:#8FBCBB">.</span><span class="token decorator annotation punctuation" style="color:#8FBCBB">post</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">errors</span><span class="token operator" style="color:#81A1C1">=</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token plain">InvalidOrderError</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token keyword" style="color:#81A1C1">async</span><span class="token plain"> </span><span class="token keyword" style="color:#81A1C1">def</span><span class="token plain"> </span><span class="token function" style="color:#88C0D0">create_orders</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"> </span><span class="token operator" style="color:#81A1C1">-</span><span class="token operator" style="color:#81A1C1">&gt;</span><span class="token plain"> Resp</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token plain">Empty</span><span class="token punctuation" style="color:#8FBCBB">,</span><span class="token plain"> status</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">CREATED</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">lhl </span><span class="token operator" style="color:#81A1C1">=</span><span class="token plain"> Lihil</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">routes</span><span class="token operator" style="color:#81A1C1">=</span><span class="token punctuation" style="color:#8FBCBB">[</span><span class="token plain">orders</span><span class="token punctuation" style="color:#8FBCBB">]</span><span class="token punctuation" style="color:#8FBCBB">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain"></span><span class="token keyword" style="color:#81A1C1">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#81A1C1">==</span><span class="token plain"> </span><span class="token string" style="color:#A3BE8C">&quot;__main__&quot;</span><span class="token punctuation" style="color:#8FBCBB">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D8DEE9"><span class="token plain">    lhl</span><span class="token punctuation" style="color:#8FBCBB">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#8FBCBB">(</span><span class="token plain">__file__</span><span class="token punctuation" style="color:#8FBCBB">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You would be able to the example response on OpenAPI at &quot;/docs&quot;, asd well as the dedicated problem page at &quot;/problems&quot;</p>
<p><img decoding="async" loading="lazy" alt="Order error diagram" src="/assets/images/order_error-c3d649e69ad39d6ffdcfb3d22e189958.png" width="1424" height="1217" class="img_ev3q"></p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a title="Best practices of webdevlopment" class="tag_zVej tagRegular_sFm0" href="/blog/tags/WebDevelopment">WebDevelopment</a></li></ul></div><div class="social-share-buttons"><button class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="32" fill="#0965FE"></circle><path d="M34.1,47V33.3h4.6l0.7-5.3h-5.3v-3.4c0-1.5,0.4-2.6,2.6-2.6l2.8,0v-4.8c-0.5-0.1-2.2-0.2-4.1-0.2 c-4.1,0-6.9,2.5-6.9,7V28H24v5.3h4.6V47H34.1z" fill="white"></path></svg></button><button class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="32" fill="#00aced"></circle><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z" fill="white"></path></svg></button><button class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="32" fill="#0077B5"></circle><path d="M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z" fill="white"></path></svg></button></div></div></footer></article></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#question" class="table-of-contents__link toc-highlight">Question:</a></li><li><a href="#what-do-people-do" class="table-of-contents__link toc-highlight">What Do People Do?</a><ul><li><a href="#bad" class="table-of-contents__link toc-highlight">Bad</a></li><li><a href="#ok" class="table-of-contents__link toc-highlight">OK</a></li><li><a href="#good" class="table-of-contents__link toc-highlight">Good</a></li></ul></li><li><a href="#how-lihil-solves-this-problem" class="table-of-contents__link toc-highlight">How lihil solves this problem</a></li><li><a href="#what-do-people-do-1" class="table-of-contents__link toc-highlight">What Do People Do?</a><ul><li><a href="#bad-1" class="table-of-contents__link toc-highlight">Bad</a></li><li><a href="#ok-1" class="table-of-contents__link toc-highlight">OK</a></li><li><a href="#good-1" class="table-of-contents__link toc-highlight">Good</a></li></ul></li><li><a href="#how-lihil-solves-this-problem-1" class="table-of-contents__link toc-highlight">How lihil solves this problem</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/lihil" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/lihil" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/lihil" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/raceychan/lihil" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 lihil, Inc.</div></div></div></footer></div>
</body>
</html>